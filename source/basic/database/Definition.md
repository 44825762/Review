### 数据库基本概念
---
1. SQL：结构化查询语言的简称， 是关系数据库的标准语言。SQL 是一种通用的、功能极强的关系数据库语言，是对关系数据存取的标准接口， 也是不同数据库系统之间互操作的基础。集数据查询、数据操作、数据定义、和数据控制功能于一体。
2. 数据定义：数据定义功能包括模式定义、表定义、视图和索引的定义。
3. 嵌套查询：指将一个查询块嵌套在另一个查询块的 WHERE 子句或 HAVING 短语的条件中的查询。
4. SQL 数据定义语句的操作对象有：模式、表、视图和索引。
5. 索引可以分为唯一索引、非唯一索引和聚簇索引三种类型。索引相关介绍可参考：索引详解
6. 触发器： 触发器是用户定义在基本表上的一类由事件驱动的特殊过程。由服务器自动激活，能执行更为复杂的检查和操作，具有更精细和更强大的数据控制能力。使用 CREATE TRIGGER 命令建立触发器。
7. 数据库设计的6个基本步骤：需求分析，概念结构设计，逻辑结构设计，物理结构设计，数据库实施，数据库运行和维护。
8. 数据库模式：是对数据库中全体数据的逻辑结构（数据项的名字、类型、取值范围等）和特征（数据之间的联系以及数据有关的安全性、完整性要求）的描述。
9. 数据库的三级系统结构：外模式、模式和内模式。
10. 数据库内模式：又称为存储模式，是对数据库物理结构和存储方式的描述，是数据在数据库内部的表示方式。一个数据库只有一个内模式。
11. 数据库外模式：又称为子模式或用户模式，它是数据库用户能够看见和使用的局部数据的逻辑结构和特征的描述，是数据库用户的数据视。通常是模式的子集。一个数据库可有多个外模式。
12. 数据库的二级映像：<font color=red>外模式/模式映像</font>、<font color=red>模式/内模式映像</font>。
13. 表相关：
    * 8.1 主键：关系型数据库中的一条记录中有若干个属性，<font color=red>若其中某一个属性组(注意是组)能唯一标识一条记录</font>，该属性组就可以成为一个主键。若表中单独一列无法成为唯一标识， 需要多个列共同标识，那么多个列的属性组称为这个表的主键。
        * 主键约束： 可以在建表的时候设置， 也可以对已存在的表设置：<font color=red>PRIMARY KEY约束为表创建主键</font>
    每个表只能有一个<font color=red>主键</font>。参与主键的所有列必须定义为<font color=red>NOT NULL</font>.当一张表,把某个列设为主键的时候,则该列就是<font color=red>主键索引</font>

                CREATE TABLE table_name (
                pk_column_1 data_type,
                pk_column_2 data type,
                ...
                PRIMARY KEY (pk_column_1, pk_column_2)
                
    * 8.2 外键：这个表中存在的其他表的主键，即为这个表的外键。外键约束：
        在引用表(定义外键的表)与被引用表(外键引用的表)之间创建依赖关系，被引用列必须是<font color=red>主键</font>或者<font color=red>唯一约束</font>，主键和外键可以是同一列。和主键不同，每个表中的外键数目不限制唯一性，在每个表中可以有0~253个外键。唯一的限制是一个给定的列只能引用一个外键。然而，一个外键可以涉及多个列。一个给定的被外键引用的列也可以被很多表引用。简单说，就是A表中的一列是B表的主键。
    
    * 8.3 约束：对表中的列进行约束， 目前支持的约束类型有：<font color=red>主键约束</font>，<font color=red>外键约束</font>，<font color=red>唯一约束</font>，<font color=red>默认约束</font>，和<font color=red>检查约束</font>。主键约束和外键约束对应上面的8.1和8.2。唯一约束确保表中的一列数据没有相同的值。与主键约束类似，唯一约束也强制唯一性，但唯一约束用于非主键的一列或者多列的组合，且一个表可以定义多个唯一约束。若在表中定义了默认值约束，用户在插入新的数据行时，如果该行没有指定数据，那么系统将默认值赋给该列，如果我们不设置默认值，系统默认为NULL。Check约束通过<font color=red>逻辑表达式来判断数据的有效性</font>，用来限制输入一列或多列的值的范围。在列中更新数据时，所要输入的内容必须满足 Check 约束的条件，否则将无法正确输入。比如只能输入男或者女。
    
---

|    区别    |  主键  |  外键  |  索引  |
| --- | --- | --- | --- |
| 定义 | 唯一标识一条记录，不能有重复的，不允许为空 | 表的外键是另一表的主键, 外键可以有重复的, 可以是空值 | 该字段没有重复值，但可以有一个空值 |
| 作用 | 用来保证数据完整性 | 用来和其他表建立联系用的 | 是提高查询排序的速度 |
| 个数 | 主键只能有一个 | 一个表可以有多个外键 | 一个表只允许有一个唯一聚集索引。 |
    
---
    

    
## 数据库的三级模式
1. 模式

    模式又称概念模式或逻辑模式，对应于概念级。它是由数据库设计者综合所有用户的数据，按照统一的观点构造的全局逻辑结构，是对数据库中全部数据的逻辑结构和特征的总体描述，是所有用户的公共数据视图(全局视图)。它是由数据库管理系统提供的数据模式描述语言(DataDescription Language，DDL)来描述、定义的，体现、反映了数据库系统的整体观。

2. 外模式

    外模式又称子模式或用户模式，对应于用户级。它是某个或某几个用户所看到的数据库的数据视图，是与某一应用有关的数据的逻辑表示。外模式是从模式导出的一个子集，包含模式中允许特定用户使用的那部分数据。用户可以通过外模式描述语言来描述、定义对应于用户的数据记录(外模式)，也可以利用数据操纵语言(DataManipulationLanguage，DML)对这些数据记录进行。外模式反映了数据库的用户观。

3. 内模式

    内模式又称存储模式，对应于物理级，它是数据库中全体数据的内部表示或底层描述，是数据库最低一级的逻辑描述，它描述了数据在存储介质上的存储方式和物理结构，对应着实际存储在外存储介质上的数据库。内模式由内模式描述语言来描述、定义，它是数据库的存储观。在一个数据库系统中，只有唯一的数据库，因而作为定义、描述数据库存储结构的内模式和定义、描述数据库逻辑结构的模式，也是唯一的，但建立在数据库系统之上的应用则是非常广泛、多样的，所以对应的外模式不是唯一的，也不可能是唯一的。

### 数据库的二级映象与数据库独立性

1. 外模式/模式映象

    模式描述的是数据的全局逻辑结构，外模式描述的是数据的局部逻辑结构。当模式改变时，由数据库管理员对各个外模式/模式的映象作相应改变，可以使外模式保持不变，从而应用程序不必修改，保证了数据与程序的逻辑独立性，简称数据的逻辑独立性

2. 模式/内模式映象

    数据库中只有一个模式，也只有一个内模式，所以模式/内模式映象是唯一的，它定义了数据库全局逻辑结构与存储结构之间的对应关系。当数据库的存储结构改变了，由数据库管理员对模式/内模式映象作相应改变，可以使模式保持不变，从而应用程序也不必改变。保证了数据与程序的物理独立性，简称数据的物理独立性。

### 超键、候选键、主键、外键

1. 超键：在关系中能唯一标识元组的属性集称为关系模式的超键。一个属性可以为作为一个超键，多个属性组合在一起也可以作为一个超键。超键包含候选键和主键。

2. 候选键：是最小超键，即没有冗余元素的超键。

3. 主键：数据库表中对储存数据对象予以唯一和完整标识的数据列或属性的组合。一个数据列只能有一个主键，且主键的取值不能缺失，即不能为空值（Null）。

4. 外键：在一个表中存在的另一个表的主键称此表的外键。

### 视图 及 应用场景

* 视图是一种虚拟的表，具有和物理表相同的功能。可以对视图进行增，改，查，操作，试图通常是有一个表或者多个表的行或列的子集。对视图的修改不影响基本表。它使得我们获取数据更容易，相比多表查询。

* 只暴露部分字段给访问者，所以就建一个虚表，就是视图。

* 查询的数据来源于不同的表，而查询者希望以统一的方式查询，这样也可以建立一个视图，把多个表查询结果联合起来，查询者只需要直接从视图中获取数据，不必考虑数据来源于不同表所带来的差异


### 游标(cursor)

游标是一段私有的SQL工作区,也就是一段内存区域,用于暂时存放受SQL语句影响到的数据。通俗理解就是将受影响的数据暂时放到了一个内存区域的虚表中，而这个虚表就是游标。

游标是一种能从包括多条数据记录的结果集中每次提取一条记录的机制。即游标用来<font color=red>逐行读取结果集</font>。游标充当指针的作用。尽管游标能遍历结果中的所有行，但他一次只指向一行。

游标的一个常见用途就是保存查询结果，以便以后使用。游标的结果集是由SELECT语句产生，如果处理过程需要重复使用一个记录集，那么创建一次游标而重复使用若干次，比重复查询数据库要快的多。

#### <font color=red>游标的作用</font>
 
 1. 大家都知道数据库中的事物可以回滚，而游标在其中起着非常重要的作用，由于对数据库的操作我们会暂时放在游标中，只要不提交，我们就可以根据游标中内容进行回滚，在一定意义有利于数据库的安全。

2. 另外，在Oracle中PL/SQL只能返回单行数据，而游标弥补了这个不足。相当于ADO.NET中的Data table吧。






